<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Widget DomusReport - Produzione</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      line-height: 1.6;
      background-color: #f5f5f5;
    }
    h1 {
      color: #2563eb;
      border-bottom: 3px solid #2563eb;
      padding-bottom: 10px;
    }
    .content {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    p {
      margin-bottom: 15px;
    }
    .highlight {
      background-color: #fef3c7;
      padding: 2px 5px;
      border-radius: 3px;
    }
    .debug-box {
      background: #e0f2fe;
      padding: 15px;
      border-radius: 5px;
      margin: 20px 0;
      border-left: 4px solid #2563eb;
    }
    .success {
      background: #d1fae5;
      border-left-color: #10b981;
    }
    .error {
      background: #fee2e2;
      border-left-color: #ef4444;
    }
  </style>
</head>
<body>
  <div class="content">
    <h1>üè† Test Widget DomusReport - PRODUZIONE</h1>

    <p>
      Questa √® una pagina di test per verificare il widget DomusReport in <strong>ambiente di produzione</strong>.
    </p>

    <div class="debug-box">
      <strong>üìã Istruzioni:</strong><br>
      1. Apri la Console del browser (F12 ‚Üí Console)<br>
      2. Verifica i log di caricamento del widget<br>
      3. Verifica che il bottone bubble appaia in basso a destra<br>
      4. Prova a cliccare il bottone<br>
      5. Controlla i log di debug per vedere cosa sta bloccando il click
    </div>

    <h2>‚úÖ Checklist Test</h2>
    <ul>
      <li>Il bottone bubble appare?</li>
      <li>Il bottone √® nella posizione corretta (bottom-right)?</li>
      <li>NON c'√® sfondo bianco che copre la pagina?</li>
      <li>Il bottone √® cliccabile?</li>
      <li>Al click si apre la chat?</li>
    </ul>

    <h2>üìÑ Contenuto di Test</h2>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt
      ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
      laboris nisi ut aliquip ex ea commodo consequat.
    </p>

    <p>
      Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
      pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
      mollit anim id est laborum.
    </p>

    <p>
      <strong>‚ö†Ô∏è Questo contenuto deve rimanere sempre visibile!</strong>
      Se vedi un overlay bianco che lo copre, il bug persiste.
    </p>
  </div>

  <!-- Widget DomusReport in produzione -->
  <script src="https://domusreport.mainstream.agency/widget-embed.js?widgetId=TEST"></script>

  <!-- Script di Debug -->
  <script>
    setTimeout(() => {
      console.log('=== DEBUG PRODUZIONE: Verifica Widget ===');

      // Verifica container
      const container = document.querySelector('#domusreport-widget-root');
      console.log('Container trovato:', container);

      // Trova bottone
      const button = container ? container.nextElementSibling : null;
      console.log('Bottone trovato:', button);

      if (button) {
        const rect = button.getBoundingClientRect();
        console.log('Posizione bottone:', {
          top: rect.top,
          left: rect.left,
          width: rect.width,
          height: rect.height
        });

        // Verifica elemento al centro del bottone
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        const elementAtPoint = document.elementFromPoint(centerX, centerY);

        console.log('Elemento al centro del bottone:', elementAtPoint);

        if (elementAtPoint === button || elementAtPoint.parentElement === button) {
          console.log('‚úÖ BOTTONE NON COPERTO - Dovrebbe essere cliccabile!');
        } else {
          console.error('‚ùå BOTTONE COPERTO DA:', elementAtPoint);
          console.log('Dettagli elemento bloccante:', {
            tag: elementAtPoint.tagName,
            id: elementAtPoint.id,
            className: elementAtPoint.className,
            zIndex: window.getComputedStyle(elementAtPoint).zIndex,
            position: window.getComputedStyle(elementAtPoint).position,
            pointerEvents: window.getComputedStyle(elementAtPoint).pointerEvents
          });
        }

        // Stili bottone
        const buttonStyles = window.getComputedStyle(button);
        console.log('Stili bottone:', {
          position: buttonStyles.position,
          zIndex: buttonStyles.zIndex,
          display: buttonStyles.display,
          pointerEvents: buttonStyles.pointerEvents,
          cursor: buttonStyles.cursor
        });
      }

      // Lista elementi fixed
      console.log('=== Tutti gli elementi fixed/absolute ===');
      document.querySelectorAll('*').forEach(el => {
        const style = window.getComputedStyle(el);
        if (style.position === 'fixed' || style.position === 'absolute') {
          console.log(`${el.tagName}#${el.id || 'no-id'}.${el.className || 'no-class'}`, {
            position: style.position,
            zIndex: style.zIndex,
            display: style.display
          });
        }
      });
    }, 3000);

    // Log click attempts
    document.addEventListener('click', (e) => {
      console.log('Click rilevato su:', e.target);
    }, true);
  </script>
</body>
</html>
